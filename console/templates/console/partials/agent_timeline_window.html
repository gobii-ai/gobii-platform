{% load agent_extras %}

{% include "console/partials/_agent_timeline_items.html" with events=timeline_window.events %}

<div id="timeline-cursors" hx-swap-oob="true"
     data-older="{{ timeline_window.window_oldest_cursor|default:'' }}"
     data-newer="{{ current_newest_cursor|default:'' }}"></div>

<div id="timeline-older-control" hx-swap-oob="true" class="flex justify-center py-2">
  {% if timeline_window.has_more_older %}
    <button
      class="inline-flex items-center gap-2 rounded-full bg-white/80 px-4 py-2 text-xs font-semibold text-slate-600 shadow-sm ring-1 ring-slate-200 hover:bg-white"
      hx-get="{{ timeline_older_url }}{% if timeline_window.window_oldest_cursor %}&cursor={{ timeline_window.window_oldest_cursor|urlencode }}{% endif %}&limit={{ timeline_limit }}&current_newest={{ current_newest_cursor|default:''|urlencode }}"
      hx-target="#timeline-events"
      hx-swap="afterbegin">
      <svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7" />
      </svg>
      Load older updates
    </button>
  {% else %}
    <span class="text-[11px] uppercase tracking-wide text-slate-300">Beginning of history</span>
  {% endif %}
</div>

<div id="timeline-newer-control" hx-swap-oob="true" class="pointer-events-none fixed inset-x-0 bottom-28 z-30 flex justify-center">
  <button
    class="pointer-events-auto inline-flex items-center gap-2 rounded-full bg-indigo-600 px-4 py-2 text-xs font-semibold text-white shadow-lg shadow-indigo-500/30 transition {{ timeline_window.has_more_newer|yesno:'','hidden' }}"
    hx-get="{{ timeline_newer_url }}{% if timeline_window.window_newest_cursor %}&cursor={{ timeline_window.window_newest_cursor|urlencode }}{% elif current_newest_cursor %}&cursor={{ current_newest_cursor|urlencode }}{% endif %}&limit={{ timeline_limit }}"
    hx-target="#timeline-events"
    hx-swap="beforeend">
    Jump to live
    <svg class="h-3 w-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5-5 5M6 7l5 5-5 5" />
    </svg>
  </button>
</div>
