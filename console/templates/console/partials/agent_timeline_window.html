{% load agent_extras %}

{% include "console/partials/_agent_timeline_items.html" with events=timeline_window.events agent_first_name=agent_first_name %}

<div id="timeline-cursors" hx-swap-oob="true"
     data-older="{{ timeline_window.window_oldest_cursor|default:'' }}"
     data-newer="{{ current_newest_cursor|default:'' }}"
     data-has-more-older="{{ timeline_window.has_more_older|yesno:'true,false' }}"
     data-has-more-newer="{{ timeline_window.has_more_newer|yesno:'true,false' }}"
     data-processing-active="{{ processing_active|yesno:'true,false' }}"
     data-direction="{{ direction }}"></div>

<div id="timeline-load-older" hx-swap-oob="true" class="timeline-load-control border-b border-slate-100" data-side="older">
  <button type="button"
          data-role="load-older-button"
          class="timeline-load-button"
          hx-get="{{ timeline_older_url }}{% if timeline_window.window_oldest_cursor %}&cursor={{ timeline_window.window_oldest_cursor|urlencode }}{% endif %}&limit={{ timeline_limit }}&current_newest={{ current_newest_cursor|default:''|urlencode }}"
          hx-target="#timeline-events"
          hx-swap="afterbegin"
          {% if not timeline_window.has_more_older %}hidden{% endif %}>
    <span class="timeline-load-indicator" aria-hidden="true"></span>
    <span class="timeline-load-label">Load older</span>
  </button>
  <span data-role="history-start"
        class="timeline-history-label"
        {% if timeline_window.has_more_older %}hidden{% endif %}>
    Beginning of history
  </span>
</div>

<div id="timeline-load-newer" hx-swap-oob="true" class="timeline-load-control border-t border-slate-100" data-side="newer" {% if not timeline_window.has_more_newer %}hidden{% endif %}>
  <button type="button"
          data-role="load-newer-button"
          class="timeline-load-button"
          hx-get="{{ timeline_newer_url }}{% if timeline_window.window_newest_cursor %}&cursor={{ timeline_window.window_newest_cursor|urlencode }}{% endif %}&limit={{ timeline_limit }}&current_newest={{ current_newest_cursor|default:''|urlencode }}"
          hx-target="#timeline-events"
          hx-swap="beforeend"
          {% if not timeline_window.has_more_newer %}hidden{% endif %}>
    <span class="timeline-load-indicator" aria-hidden="true"></span>
    <span class="timeline-load-label">Load newer</span>
  </button>
</div>

<button id="jump-to-latest" hx-swap-oob="true"
        class="jump-to-latest hidden"
        type="button"
        aria-label="Jump to latest"
        aria-hidden="true"
        style="display:none;opacity:0">
  <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 5v14m0 0-5-5m5 5 5-5" />
  </svg>
  <span class="sr-only">Jump to latest</span>
</button>

<div id="processing-state" hx-swap-oob="true" class="hidden" style="display:none" data-processing-active="{{ processing_active|yesno:'true,false' }}"></div>
