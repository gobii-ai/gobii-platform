{% load agent_extras %}
{% load humanize %}
{% load tz %}

{% comment %}
  Top-level renderer for the agent timeline. Messages are rendered inline; step cards are delegated
  to `_timeline_step_card.html` to keep the template logic manageable.
{% endcomment %}

{% with suppress_empty=suppress_empty|default:False %}
{% for item in events|group_timeline_events %}
  {% if item.type == 'message' %}
    {% include "console/partials/_timeline_message_card.html" with event=item.event message=item.message agent_first_name=agent_first_name %}
  {% elif item.type == 'steps' %}
    {% include "console/partials/_timeline_step_cluster.html" with cluster=item %}
  {% endif %}
{% empty %}
  {% if not suppress_empty %}
    <div class="timeline-empty text-center text-sm text-slate-400">No activity yet.</div>
  {% endif %}
{% endfor %}
{% endwith %}
