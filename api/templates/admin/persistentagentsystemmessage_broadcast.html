{% extends "admin/base_site.html" %}
{% load i18n %}

{% block breadcrumbs %}
  <div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
    &rsaquo; <a href="{% url 'admin:app_list' 'api' %}">API</a>
    &rsaquo; <a href="{% url 'admin:api_persistentagentsystemmessage_changelist' %}">{% trans 'Persistent agent system messages' %}</a>
    &rsaquo; Broadcast System Message
  </div>
{% endblock %}

{% block content %}
  <h1>Broadcast System Message</h1>
  <p>
    Create a single system directive that will be duplicated for
    <strong>{{ agent_count }}</strong> persistent agent{% if agent_count != 1 %}s{% endif %}.
    Use this to quickly deliver the same instruction to every agent.
  </p>
  <p class="warning">
    Saving will <strong>not</strong> trigger event processing. Queue it manually later if delivery should start immediately.
  </p>
  {% if agent_count == 0 %}
    <p class="warning">No persistent agents currently exist, so nothing will be queued.</p>
  {% endif %}
  <form method="post" novalidate>
    {% csrf_token %}
    <fieldset class="module aligned">
      {% if form.non_field_errors %}
        <div class="form-row errors">{{ form.non_field_errors }}</div>
      {% endif %}
      <div class="form-row">
        {{ form.message.label_tag }}
        {{ form.message }}
        {% if form.message.errors %}
          <div class="errors">{{ form.message.errors }}</div>
        {% endif %}
        {% if form.message.help_text %}
          <p class="help">{{ form.message.help_text }}</p>
        {% endif %}
      </div>
    </fieldset>
    <div class="submit-row">
      <a class="button" href="{% url 'admin:api_persistentagentsystemmessage_changelist' %}">Cancel</a>
      <button type="submit" class="button default">Broadcast Message</button>
    </div>
  </form>
{% endblock %}
